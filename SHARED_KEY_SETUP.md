# 共有キー版のセットアップ方法

**チーム内でAPIキーを共有して、メンバー全員がキー設定なしで使えるようにする方法**

---

## 📋 管理者がやること（初回のみ）

### 1. APIキーを取得

1. https://fal.ai/ にアクセス
2. Googleアカウントでログイン
3. Dashboard → API Keys → Create New Key
4. 表示されたキー（`fal_...`で始まる）をコピー

### 2. ノートブックにAPIキーを埋め込む

⚠️ **重要**: テンプレートをコピーしてから編集してください

1. `pmax_helper_shared_key.ipynb` を別名でコピー
   - 例: `pmax_helper_shared_key_company.ipynb`
   - こうすることで、誤ってGitHubにpushされるのを防げます

2. コピーしたファイルをテキストエディタで開く

3. 以下の行を見つける：
   ```python
   FAL_KEY = "YOUR_FAL_KEY_HERE"  # fal.aiのAPIキー
   ```

4. `YOUR_FAL_KEY_HERE` を実際のAPIキーに置き換える：
   ```python
   FAL_KEY = "fal_xxxxxxxxxxxxxxxxx"  # fal.aiのAPIキー
   ```

5. ファイルを保存

### 3. ノートブックを共有

**方法A: Google Driveで共有（推奨）**

1. `pmax_helper_shared_key.ipynb` をGoogle Driveにアップロード
2. ファイルを右クリック → 「共有」
3. メンバーのメールアドレスを追加
4. 権限を「閲覧者」または「編集者」に設定
5. 「完了」をクリック

メンバーには以下のように案内：
```
Google Driveの共有ファイル「pmax_helper_shared_key.ipynb」を開いてください。
画面上部の「アプリで開く」→「Google Colaboratory」を選択してください。
```

**方法B: Slackやメールで直接送る**

1. `pmax_helper_shared_key.ipynb` ファイルを添付して送信
2. メンバーに以下の手順を案内：
   - Google Colab (https://colab.research.google.com/) を開く
   - 「ファイル」→「ノートブックをアップロード」
   - ダウンロードした `.ipynb` ファイルをアップロード

**方法C: プライベートGitHubリポジトリ（上級者向け）**

1. GitHubでプライベートリポジトリを作成
2. `pmax_helper_shared_key.ipynb` をpush
3. メンバーをリポジトリに招待
4. メンバーは以下のURLでアクセス：
   ```
   https://colab.research.google.com/github/YOUR_ORG/YOUR_REPO/blob/main/pmax_helper_shared_key.ipynb
   ```

---

## 👥 メンバーがやること

### Google Driveから開く場合

1. 共有されたGoogle Driveのリンクを開く
2. `pmax_helper_shared_key.ipynb` をクリック
3. 「アプリで開く」→「Google Colaboratory」を選択
4. セル1, 2, 3を上から順番に実行
5. LP URLを入力して「🔍 ページを分析」→「🎬 動画を生成」

### ファイルをダウンロードした場合

1. https://colab.research.google.com/ を開く
2. 「ファイル」→「ノートブックをアップロード」
3. ダウンロードした `pmax_helper_shared_key.ipynb` を選択
4. セル1, 2, 3を上から順番に実行
5. LP URLを入力して「🔍 ページを分析」→「🎬 動画を生成」

---

## ⚠️ セキュリティ上の注意

### ❌ やってはいけないこと

1. **公開GitHubリポジトリにpushしない**
   - APIキーが含まれているため、全世界に公開されます
   - 悪用されて高額請求される可能性があります

2. **SNSや公開フォーラムに投稿しない**
   - 同様の理由で危険です

3. **社外の人に共有しない**
   - APIの利用料金は共有キーの所有者に請求されます

### ✅ 推奨セキュリティ対策

1. **定期的にキーをローテーション**
   - 3-6ヶ月に一度、新しいキーを発行して古いキーを削除

2. **利用状況を監視**
   - fal.ai Dashboard で利用量をチェック
   - 異常な利用があればすぐキーを無効化

3. **利用メンバーを最小限に**
   - 本当に必要な人だけに共有

4. **Google Driveの共有設定を厳格に**
   - 「リンクを知っている全員」ではなく、個別にメールアドレスを指定

---

## 🔄 APIキーを更新する方法

メンバー全員が新しいキーを使う必要がある場合：

1. 管理者が新しいAPIキーを取得
2. `pmax_helper_shared_key.ipynb` の `FAL_KEY` を更新
3. 更新したファイルを再共有
4. メンバーに「最新版を使ってください」と連絡

**Google Drive共有の場合**: 自動的に最新版が反映されます（要リロード）

---

## 💰 コストについて

- **fal.ai**: 動画生成1回あたり約$0.10-0.50（モデルによる）
- 無料枠を超えると、キー所有者のアカウントに課金されます
- 定期的にDashboardで使用量を確認してください

**コスト管理のヒント**:
- fal.ai Dashboardで使用制限（Spending Limit）を設定
- 月次レポートを確認

---

## ❓ よくある質問

### Q: APIキーを間違えて公開してしまった

**A:** すぐに以下を実行してください：
1. fal.ai Dashboard → API Keys
2. 該当するキーを「Delete」
3. 新しいキーを発行
4. ノートブックを更新して再共有

### Q: メンバーが増えたら課金額も増える？

**A:** はい。使った分だけ課金されるので、利用回数が増えるとコストも増えます。
定期的に使用量を確認しましょう。

### Q: 特定のメンバーの使用量を制限したい

**A:** 共有キー方式では個別制限はできません。
個別管理が必要な場合は、各自がAPIキーを取得する方式（`pmax_helper_simple.ipynb`）を使ってください。

### Q: ノートブックを編集されたくない

**A:** Google Drive共有時に権限を「閲覧者」に設定してください。
メンバーはコピーを作成して使用できますが、元のファイルは保護されます。

---

## 📞 トラブル時の連絡先

- 技術的な問題: [管理者の連絡先]
- APIキー関連: [管理者の連絡先]

---

**🔒 このドキュメントも外部に公開しないでください**
